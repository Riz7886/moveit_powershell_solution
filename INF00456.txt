# HARDCODED - NO INPUT NEEDED

$workspace = "https://adb-324884819348686.6.azuredatabricks.net"
$token = "dapi9abaad71d0865d1a32a08cba05a318b7"  # Your "quota check" token from today

$headers = @{
    "Authorization" = "Bearer $token"
    "Content-Type" = "application/json"
}

Write-Host "=== CHECKING CLUSTERS ===" -ForegroundColor Yellow

$clusters = Invoke-RestMethod -Uri "$workspace/api/2.0/clusters/list" -Headers $headers -Method Get

foreach ($c in $clusters.clusters) {
    Write-Host "`nCluster: $($c.cluster_name)" -ForegroundColor Green
    Write-Host "  State: $($c.state)"
    
    if (-not $c.autoscale) {
        Write-Host "  WARNING: NO AUTOSCALING!" -ForegroundColor Red
    } else {
        Write-Host "  Autoscale: $($c.autoscale.min_workers)-$($c.autoscale.max_workers) workers"
    }
    
    if (-not $c.autotermination_minutes) {
        Write-Host "  WARNING: NO AUTO-TERMINATION!" -ForegroundColor Red
    }
}

Write-Host "`nDONE" -ForegroundColor Green